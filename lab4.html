<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiến trúc Client-Server: React & Spring Boot</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            margin: 0;
            padding: 40px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
        }
        .container {
            max-width: 1300px;
            margin: 0 auto;
            background: #fff;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        h2 {
            color: #2980b9;
            margin-top: 30px;
        }
        h3 {
            color: #34495e;
        }
        .section {
            margin-bottom: 50px;
            padding: 20px;
            background: #fafafa;
            border-radius: 10px;
            transition: transform 0.3s;
        }
        .section:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .diagram {
            text-align: center;
            margin: 30px 0;
        }
        svg {
            max-width: 100%;
            height: auto;
        }
        .component-box {
            fill: #ecf0f1;
            stroke: #2c3e50;
            stroke-width: 2;
        }
        .component-text {
            font-size: 16px;
            font-weight: bold;
            fill: #2c3e50;
        }
        .arrow {
            fill: none;
            stroke: #7f8c8d;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #3498db;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        tr:hover {
            background: #f1f8ff;
        }
        ul {
            padding-left: 25px;
            list-style: square;
        }
        ul li {
            margin-bottom: 10px;
        }
        .highlight {
            background: #e8f4f8;
            padding: 5px 10px;
            border-radius: 5px;
            display: inline-block;
        }
        .sub-list {
            padding-left: 40px;
            list-style: circle;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Phần a: Tên mẫu kiến trúc -->
        <div class="section">
            <h1>a) Tên của mẫu kiến trúc được chọn</h1>
            <p><strong>Mẫu kiến trúc:</strong> <span class="highlight">Kiến trúc Client-Server phân tầng (Layered Client-Server Architecture)</span></p>
            <p><strong>Mô tả chi tiết:</strong> Đây là một kiến trúc Client-Server cơ bản với các tầng: tầng giao diện (Presentation Layer) do Client đảm nhiệm, tầng nghiệp vụ (Business Logic Layer) và tầng dữ liệu (Data Layer) do Server xử lý. Client (React) giao tiếp trực tiếp với Backend Services (Spring Boot) qua giao thức HTTP/REST mà không cần API Gateway trung gian. Dữ liệu được lưu trữ tập trung trong Database (SQL Server) thay vì sử dụng Cloud Storage riêng biệt.</p>
            <p><strong>Lý do chọn:</strong> Phù hợp với hệ thống quản lý học tập trực tuyến đơn giản, giảm độ phức tạp bằng cách loại bỏ API Gateway và Cloud Storage, tập trung vào hiệu suất và tích hợp chặt chẽ giữa React, Spring Boot, và SQL Server.</p>
        </div>

        <!-- Phần b: Biểu đồ kiến trúc -->
        <div class="section">
            <h1>b) Biểu đồ mô tả kiến trúc</h1>
            <div class="diagram">
                <svg width="700" height="250">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#7f8c8d" />
                        </marker>
                    </defs>
                    <!-- Client -->
                    <rect x="50" y="100" width="150" height="80" rx="10" class="component-box" />
                    <text x="125" y="140" text-anchor="middle" class="component-text">Client (React)</text>
                    <!-- Backend Services -->
                    <rect x="250" y="100" width="150" height="80" rx="10" class="component-box" />
                    <text x="325" y="140" text-anchor="middle" class="component-text">Backend Services</text>
                    <!-- Database -->
                    <rect x="450" y="100" width="150" height="80" rx="10" class="component-box" />
                    <text x="525" y="140" text-anchor="middle" class="component-text">Database (SQL Server)</text>
                    <!-- AI Services -->
                    <rect x="250" y="200" width="150" height="60" rx="10" class="component-box" />
                    <text x="325" y="230" text-anchor="middle" class="component-text">AI Services</text>
                    <!-- Arrows -->
                    <path d="M200 140 H250" class="arrow" />
                    <path d="M400 140 H450" class="arrow" />
                    <path d="M325 180 V200" class="arrow" />
                </svg>
            </div>
            <p><em>Ghi chú: Các mũi tên thể hiện luồng dữ liệu hai chiều giữa Client và Backend Services, cũng như giữa Backend Services với Database và AI Services.</em></p>
        </div>

        <!-- Phần c: Danh sách thành phần -->
        <div class="section">
            <h1>c) Danh sách các thành phần trong kiến trúc</h1>
            <ul>
                <li><strong>Client (Frontend)</strong></li>
                <li><strong>Backend Services</strong></li>
                <li><strong>Database</strong></li>
                <li><strong>AI Services</strong></li>
            </ul>
        </div>

        <!-- Phần d: Mô tả chức năng của từng thành phần -->
        <div class="section">
            <h1>d) Mô tả chức năng của từng thành phần</h1>
            <table>
                <tr>
                    <th>Thành phần</th>
                    <th>Chức năng chi tiết</th>
                </tr>
                <tr>
                    <td>Client (Frontend)</td>
                    <td>
                        <ul>
                            <li><strong>Quản lý người dùng:</strong> Hiển thị form đăng ký (email, mật khẩu, tên, số điện thoại) với validation (email: regex kiểm tra định dạng, mật khẩu: tối thiểu 8 ký tự, có chữ cái và số); gửi POST request trực tiếp đến Backend Services (/api/users/register). Form đăng nhập yêu cầu email/mật khẩu, gửi POST request (/api/users/login), nhận JWT và lưu vào localStorage để xác thực các request sau.</li>
                            <li><strong>Quản lý khóa học:</strong> Hiển thị danh sách khóa học dưới dạng card (tên, mô tả ngắn, thời lượng), click vào card mở modal chi tiết (giáo viên, lịch học, số học viên); gửi GET request (/api/courses) để lấy dữ liệu từ Backend Services.</li>
                            <li><strong>Quản lý tài liệu:</strong> Hiển thị danh sách tài liệu (PDF, video) trong tab khóa học/lớp học, nút tải xuống gửi GET request (/api/documents/{id}) để lấy file trực tiếp từ Backend Services (lưu trong Database dưới dạng BLOB).</li>
                            <li><strong>Quản lý lớp học:</strong> Hiển thị bảng lớp học (tên, trạng thái: đang diễn ra/đã kết thúc, số học viên), chi tiết lớp (danh sách học viên, giáo viên) trong accordion; gửi GET request (/api/classes).</li>
                            <li><strong>Quản lý buổi học:</strong> Hiển thị lịch buổi học (ngày, giờ, trạng thái) trong calendar view; giao diện điểm danh (checkbox danh sách học viên) và textarea nhận xét cho giáo viên, gửi POST request (/api/sessions/{id}/attendance).</li>
                            <li><strong>Quản lý bài tập:</strong> Hiển thị danh sách bài tập (trắc nghiệm: radio buttons, tự luận: textarea/upload file), đồng hồ đếm ngược thời hạn nộp bài; gửi POST request (/api/assignments/{id}/submit) kèm file hoặc câu trả lời.</li>
                            <li><strong>Quản lý kết quả học tập:</strong> Hiển thị bảng điểm (bài tập, kiểm tra) và biểu đồ cột (tiến độ theo tuần/tháng); gửi GET request (/api/results/student/{id}).</li>
                            <li><strong>Quản lý nhận xét:</strong> Hiển thị form nhận xét (textarea, nút gửi) cho giáo viên, danh sách nhận xét (có nút phản hồi) cho học viên; gửi POST request (/api/comments).</li>
                            <li><strong>Quản lý trang Feed:</strong> Hiển thị thông báo hệ thống (toast notification), cập nhật khóa học/lớp học trong timeline; gửi GET request (/api/feed) để lấy dữ liệu real-time.</li>
                            <li><strong>Quản lý chứng chỉ:</strong> Hiển thị nút tải chứng chỉ (PDF) khi hoàn thành khóa học; gửi GET request (/api/certificates/{id}) để lấy file từ Backend Services.</li>
                            <li><strong>Chức năng học viên:</strong> Giao diện bài kiểm tra đầu vào (trắc nghiệm với timer 30 phút, câu hỏi random từ ngân hàng đề), kết quả và lộ trình gợi ý hiển thị trong dashboard; gửi POST request (/api/assessments/submit).</li>
                            <li><strong>Chức năng giáo viên:</strong> Form upload tài liệu (drag-and-drop, giới hạn 50MB), form tạo bài tập (trắc nghiệm: nhập câu hỏi/đáp án, tự luận: nhập đề), bảng điểm danh; gửi POST request (/api/documents, /api/assignments).</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>Backend Services</td>
                    <td>
                        <ul>
                            <li><strong>Quản lý người dùng:</strong>
                                <ul class="sub-list">
                                    <li>Đăng ký: Nhận POST /api/users/register (email, mật khẩu, tên, số điện thoại), băm mật khẩu bằng BCrypt, kiểm tra email duy nhất (SELECT COUNT(*) FROM users WHERE email=?), lưu vào Database, trả về user_id.</li>
                                    <li>Đăng nhập: Nhận POST /api/users/login, so sánh mật khẩu băm, tạo JWT (header: alg=HS256, payload: user_id, role, exp=24h), trả về token.</li>
                                    <li>Phân quyền: Kiểm tra JWT trong header Authorization cho mỗi request, gán role (ROLE_STUDENT, ROLE_TEACHER, ROLE_ADMIN) từ bảng user_roles.</li>
                                    <li>Cập nhật: Nhận PUT /api/users/{id}, kiểm tra quyền (chỉ user hoặc admin), cập nhật thông tin (UPDATE users SET name=?, phone=? WHERE id=?).</li>
                                    <li>Xóa: Nhận DELETE /api/users/{id}, kiểm tra quyền admin, xóa mềm (UPDATE users SET is_deleted=1 WHERE id=?).</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý khóa học:</strong>
                                <ul class="sub-list">
                                    <li>Tạo: Nhận POST /api/courses (name, description, duration), lưu vào bảng courses (INSERT INTO courses VALUES (...)), trả về course_id.</li>
                                    <li>Chỉnh sửa: Nhận PUT /api/courses/{id}, kiểm tra quyền (teacher/admin), cập nhật (UPDATE courses SET name=?, description=? WHERE id=?).</li>
                                    <li>Xóa: Nhận DELETE /api/courses/{id}, kiểm tra trạng thái (SELECT COUNT(*) FROM classes WHERE course_id=?), xóa mềm nếu không có lớp học liên quan.</li>
                                    <li>Gán giáo viên: Nhận PATCH /api/courses/{id}/teachers, thêm vào bảng course_teachers (INSERT INTO course_teachers VALUES (course_id, teacher_id)).</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý tài liệu:</strong>
                                <ul class="sub-list">
                                    <li>Upload: Nhận POST /api/documents (file, course_id), lưu file dưới dạng BLOB trong bảng documents (INSERT INTO documents (name, content, course_id) VALUES (?, ?, ?)).</li>
                                    <li>Truy xuất: Nhận GET /api/documents/{id}, lấy dữ liệu BLOB (SELECT content FROM documents WHERE id=?), trả về file qua response stream.</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý lớp học:</strong>
                                <ul class="sub-list">
                                    <li>Tổ chức: Nhận POST /api/classes (course_id, student_ids, teacher_id), lưu vào bảng classes, thêm liên kết vào class_students/class_teachers.</li>
                                    <li>Gán học viên/giáo viên: Nhận PATCH /api/classes/{id}, cập nhật bảng class_students/class_teachers (INSERT/DELETE).</li>
                                    <li>Lịch học: Nhận GET /api/classes/{id}/schedules, truy vấn bảng schedules (SELECT * WHERE class_id=?).</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý buổi học:</strong>
                                <ul class="sub-list">
                                    <li>Lên lịch: Nhận POST /api/sessions (class_id, date, time), lưu vào bảng sessions (INSERT INTO sessions VALUES (...)).</li>
                                    <li>Theo dõi tiến độ: Nhận PATCH /api/sessions/{id}, cập nhật trạng thái (UPDATE sessions SET status=? WHERE id=?).</li>
                                    <li>Điểm danh: Nhận POST /api/sessions/{id}/attendance (student_ids), lưu vào bảng attendance (INSERT INTO attendance VALUES (session_id, student_id, 1)).</li>
                                    <li>Nhận xét: Nhận POST /api/comments (session_id, content), lưu vào bảng comments.</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý bài tập:</strong>
                                <ul class="sub-list">
                                    <li>Tạo: Nhận POST /api/assignments (type, content, deadline), lưu vào bảng assignments (trắc nghiệm: JSON câu hỏi/đáp án, tự luận: text).</li>
                                    <li>Nộp bài: Nhận POST /api/assignments/{id}/submit (student_id, content), lưu vào bảng submissions.</li>
                                    <li>Chấm điểm: Trắc nghiệm (so sánh đáp án, lưu điểm vào results), tự luận (nhận PATCH /api/submissions/{id} từ giáo viên).</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý kết quả học tập:</strong>
                                <ul class="sub-list">
                                    <li>Lưu trữ: Nhận điểm từ bài tập/kiểm tra, lưu vào bảng results (INSERT INTO results VALUES (student_id, assignment_id, score)).</li>
                                    <li>Báo cáo: Nhận GET /api/results/student/{id}, tính điểm trung bình (SELECT AVG(score) FROM results WHERE student_id=?).</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý nhận xét:</strong>
                                <ul class="sub-list">
                                    <li>Lưu: Nhận POST /api/comments (user_id, content, session_id/assignment_id), lưu vào bảng comments.</li>
                                    <li>Phản hồi: Nhận POST /api/comments (parent_id), liên kết nhận xét gốc.</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý trang Feed:</strong>
                                <ul class="sub-list">
                                    <li>Tạo thông báo: Nhận POST /api/feed (content), lưu vào bảng feeds.</li>
                                    <li>Cập nhật: Nhận GET /api/feed, truy vấn (SELECT * FROM feeds ORDER BY created_at DESC LIMIT 10).</li>
                                </ul>
                            </li>
                            <li><strong>Quản lý chứng chỉ:</strong>
                                <ul class="sub-list">
                                    <li>Cấp: Kiểm tra hoàn thành khóa học (SELECT COUNT(*) FROM results WHERE course_id=? AND student_id=?), tạo PDF (iText), lưu BLOB vào bảng certificates.</li>
                                    <li>Tải: Nhận GET /api/certificates/{id}, trả về file từ Database qua response stream.</li>
                                </ul>
                            </li>
                            <li><strong>Chức năng học viên:</strong>
                                <ul class="sub-list">
                                    <li>Đăng ký/đăng nhập: Xử lý trực tiếp qua /api/users/register và /api/users/login.</li>
                                    <li>Kiểm tra đầu vào: Nhận POST /api/assessments/submit (answers), tính điểm, gửi sang AI Services qua API nội bộ.</li>
                                </ul>
                            </li>
                            <li><strong>Chức năng giáo viên:</strong>
                                <ul class="sub-list">
                                    <li>Thao tác tài liệu: Nhận POST /api/documents, lưu file BLOB vào Database.</li>
                                    <li>Thao tác bài tập: Nhận POST /api/assignments, PATCH /api/submissions/{id} để chấm điểm.</li>
                                    <li>Thao tác buổi học: Nhận POST /api/sessions/{id}/attendance và /api/comments.</li>
                                </ul>
                            </li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>Database</td>
                    <td>
                        <ul>
                            <li><strong>Quản lý người dùng:</strong> Bảng users (id, email, password_hash, name, phone, role, is_deleted), user_roles (user_id, role).</li>
                            <li><strong>Quản lý khóa học:</strong> Bảng courses (id, name, description, duration, is_deleted), course_teachers (course_id, teacher_id).</li>
                            <li><strong>Quản lý tài liệu:</strong> Bảng documents (id, name, content BLOB, course_id, uploaded_by, uploaded_at).</li>
                            <li><strong>Quản lý lớp học:</strong> Bảng classes (id, course_id), class_students (class_id, student_id), class_teachers (class_id, teacher_id), schedules (id, class_id, date, time).</li>
                            <li><strong>Quản lý buổi học:</strong> Bảng sessions (id, class_id, date, status), attendance (session_id, student_id, present).</li>
                            <li><strong>Quản lý bài tập:</strong> Bảng assignments (id, type, content JSON/text, deadline), submissions (id, assignment_id, student_id, content BLOB/text, submitted_at).</li>
                            <li><strong>Quản lý kết quả học tập:</strong> Bảng results (id, student_id, assignment_id, score, created_at).</li>
                            <li><strong>Quản lý nhận xét:</strong> Bảng comments (id, user_id, content, session_id, assignment_id, parent_id, created_at).</li>
                            <li><strong>Quản lý trang Feed:</strong> Bảng feeds (id, content, created_at).</li>
                            <li><strong>Quản lý chứng chỉ:</strong> Bảng certificates (id, student_id, course_id, content BLOB, issued_at).</li>
                            <li><strong>Tối ưu:</strong> Index trên user_id, course_id, student_id; partition bảng results theo student_id nếu dữ liệu lớn.</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>AI Services</td>
                    <td>
                        <ul>
                            <li><strong>Chức năng học viên - Kiểm tra đầu vào:</strong> Nhận dữ liệu từ Backend Services qua API nội bộ (POST /ai/assess, body: {student_id, answers}), dùng mô hình ML (KNN hoặc Decision Tree) để phân loại trình độ (A1, A2, B1).</li>
                            <li><strong>Gợi ý lộ trình:</strong> Trả về JSON ({level: "A1", recommended_courses: [id1, id2]}) cho Backend Services, lưu vào bảng student_paths (student_id, level, course_ids).</li>
                            <li><strong>Tối ưu hóa:</strong> Train mô hình định kỳ với dữ liệu từ results (SELECT score FROM results WHERE assignment_id IN (kiểm tra đầu vào)), tích hợp Spring AI.</li>
                        </ul>
                    </td>
                </tr>
            </table>
        </div>

        <!-- Phần e: Công nghệ được chọn -->
        <div class="section">
            <h1>e) Công nghệ được chọn</h1>
            <table>
                <tr>
                    <th>Thành phần</th>
                    <th>Công nghệ/Phần mềm</th>
                    <th>Lý do chọn</th>
                </tr>
                <tr>
                    <td>Client (Frontend)</td>
                    <td>React, Tailwind CSS</td>
                    <td>React: UI động, tái sử dụng component. Tailwind: CSS nhanh, responsive.</td>
                </tr>
                <tr>
                    <td>Backend Services</td>
                    <td>Spring Boot, Spring System</td>
                    <td>Spring Boot: Xử lý logic nghiệp vụ, REST API. Spring System: Quản lý hệ thống.</td>
                </tr>
                <tr>
                    <td>Database</td>
                    <td>SQL Server</td>
                    <td>Cơ sở dữ liệu quan hệ, truy vấn nhanh, tích hợp tốt với Spring.</td>
                </tr>
                <tr>
                    <td>AI Services</td>
                    <td>Spring AI</td>
                    <td>Tích hợp AI vào Spring, hỗ trợ ML đơn giản.</td>
                </tr>
                <tr>
                    <td>Công cụ hỗ trợ</td>
                    <td>Trello, Postman</td>
                    <td>Trello: Quản lý dự án. Postman: Test API.</td>
                </tr>
                <tr>
                    <td>Phần cứng</td>
                    <td>Server vật lý hoặc VM (Docker)</td>
                    <td>Triển khai ứng dụng linh hoạt, tối ưu tài nguyên.</td>
                </tr>
            </table>
        </div>
    </div>
</body>
</html>